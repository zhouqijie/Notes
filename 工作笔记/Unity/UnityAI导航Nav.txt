# 注意事项

## 使用自定义的移动控制

关闭自动更新位置和自动更新旋转:
```
agent.updatePosition = false;
agent.updateRotation = false;
agent.updateUpAxis = false;
```

## 代理模拟位置重置到角色

自定义移动时有时需要循环重置代理：
```
var tmp = agent.destination;
agent.Warp(this.transform.position);
agent.SetDestination(tmp);
```

BUG：Agent重新设置Destination时进入pathPending，此时RemainDistance值为零。

修改方法：：`bool reach = !agent.pathPending && (agent.remainingDistance <= agent.stoppingDistance);`




## RemainDistance值为无穷大的问题

NavMeshAgent.remainingDistance 仍然只在到达路径的倒数第二个角落后才计算。在此之前，剩余距离将返回无穷大。

获取真实RemainingDistance方法：
```
public float GetRemainingDistance()
{
     float distance = 0;
     Vector3[] corners = m_navMeshAgent.path.corners;

     if (corners.Length > 2)
     {
           for (int i = 1; i < corners.Length; i++)
           {
                 Vector2 previous = new Vector2(corners[i - 1].x, corners[i - 1].z);
                 Vector2 current = new Vector2(corners[i].x, corners[i].z);

                 distance += Vector2.Distance(previous, current);
           }
     }
     else 
     {
           distance = m_navMeshAgent.remainingDistance;
     }
   
     return distance;
}
```